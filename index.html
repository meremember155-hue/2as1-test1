<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>مهامي</title>
<style>
  body {
    font-family: 'Tajawal', sans-serif;
    background-color: white;
    color: #333;
    margin: 0;
    padding: 0;
  }

  header {
    background-color: #ff8c00;
    color: white;
    text-align: center;
    padding: 15px 0;
    font-size: 1.8em;
    font-weight: bold;
  }

  .header-extra {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
    background-color: white;
    padding: 8px 0;
  }
  .header-extra button {
    background-color: #ff8c00;
    color: white;
    border: none;
    padding: 5px 12px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 0.9em;
  }

  .tasks {
    max-width: 400px;
    margin: 20px auto;
    padding: 0 10px;
  }

  .task {
    background-color: #ff8c00;
    border-radius: 10px;
    padding: 15px;
    margin-bottom: 15px;
    position: relative;
    box-shadow: 0 3px 5px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
  }
  .task h2 {
    margin-bottom: 5px;
    font-size: 1.2em;
  }
  .task p {
    margin-bottom: 5px;
    color: #555;
    font-size: 0.9em;
  }
  .task .date {
    font-size: 0.8em;
    color: #777;
  }
  .task button {
    margin-top: 8px;
    background-color: #ff7f50;
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 0.9em;
  }
  .task input[type="checkbox"] {
    position: absolute;
    top: 15px;
    left: 15px;
    width: 18px;
    height: 18px;
    cursor: pointer;
  }

  /* نافذة السجل */
  #log {
    display: none;
    max-width: 400px;
    margin: 10px auto;
    background-color: #fff3e0;
    padding: 10px;
    border-radius: 8px;
    box-shadow: 0 3px 5px rgba(0,0,0,0.1);
  }
  #log h3 {
    text-align: center;
    font-size: 1.1em;
    margin-bottom: 5px;
  }
  #log ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  #log li {
    padding: 5px 0;
    border-bottom: 1px solid #ffd1b3;
    font-size: 0.9em;
  }
</style>
</head>
<body>

<header>مهامي</header>

<div class="header-extra">
  <button id="showLogBtn">سجل</button>
  <button onclick="location.reload()">تحديث الصفحة</button>
</div>

<div class="tasks">
  <div class="task" data-id="1">
    <input type="checkbox">
    <h2>الرياضيات</h2>
    <p>حل سلسلة</p></p>
    <div class="date">تاريخ: 2025/11/21</div>
    <button onclick="downloadFile('file1.txt')">حل المهمة</button>
  </div>

  <div class="task" data-id="2">
    <input type="checkbox">
    <h2>المهمة 2</h2>
    <p>وصف خفيف للمهمة الثانية.</p>
    <div class="date">تاريخ: 2025/11/21</div>
    <button onclick="downloadFile('file2.txt')">حل المهمة</button>
  </div>
</div>

<!-- نافذة السجل -->
<div id="log">
  <h3>المهام المنجزة</h3>
  <ul id="logList"></ul>
</div>

<script>
  const tasks = document.querySelectorAll('.task');
  const logList = document.getElementById('logList');
  const showLogBtn = document.getElementById('showLogBtn');
  const logDiv = document.getElementById('log');

  function updateLog() {
    logList.innerHTML = '';
    for(let i = 0; i < localStorage.length; i++){
      const key = localStorage.key(i);
      if(key.startsWith('task_')){
        const taskTitle = JSON.parse(localStorage.getItem(key)).title;
        const li = document.createElement('li');
        li.textContent = taskTitle;
        logList.appendChild(li);
      }
    }
  }

  showLogBtn.addEventListener('click', () => {
    if(logDiv.style.display === 'none'){
      updateLog();
      logDiv.style.display = 'block';
    } else {
      logDiv.style.display = 'none';
    }
  });

  // حفظ حالة المهمة وإخفاءها عند إنهاء المهمة
  tasks.forEach(task => {
    const checkbox = task.querySelector('input[type="checkbox"]');
    const taskId = task.dataset.id;
    const title = task.querySelector('h2').textContent;

    // استعادة الحالة عند تحميل الصفحة
    const saved = localStorage.getItem('task_' + taskId);
    if(saved){
      task.style.display = 'none';
    }

    checkbox.addEventListener('change', () => {
      if(checkbox.checked){
        localStorage.setItem('task_' + taskId, JSON.stringify({ title: title }));
        task.style.display = 'none';
        updateLog();
      } else {
        localStorage.removeItem('task_' + taskId);
        task.style.display = 'block';
        updateLog();
      }
    });
  });

  function downloadFile(filename) {
    const element = document.createElement('a');
    const fileContent = "هذا محتوى " + filename;
    const blob = new Blob([fileContent], { type: 'text/plain' });
    element.href = URL.createObjectURL(blob);
    element.download = filename;
    document.body.appendChild(element);
    element.click();
    document.body.removeChild(element);
  }

</script>
</body>
</html>

